define("wkview:widget/common_toc_reader/reader_ppt/flowppt/data.js",function(e,t,a){var _=e("wkcommon:widget/ui/lib/jquery/jquery.js"),i=e("wkcommon:widget/ui/lib/lang/lang.js"),n="//wenku.baidu.com",c="/browse/getbcsurl?doc_id=__DOC_ID__&pn=1&rn=__RN__&type=ppt&callback=?",r=i.createClass(function(e){this.id=e,this.cache=null}).extend({getData:function(){var e=this;return e.api=c.replace(/__DOC_ID__/g,e.id).replace(/__RN__/g,99999),_.getJSON(n+e.api)}});a.exports.Data=r});
;define("wkview:widget/common_toc_reader/reader_ppt/flowppt/flowppt.js",function(o,e,n){var t=o("wkview:widget/ui/html_view/widget.js").widget,i=o("wkview:widget/common_toc_reader/reader_ppt/flowppt/data.js").Data,a=o("wkcommon:widget/ui/js_core/mvp/template/template.js").template,s=o("wkcommon:widget/ui/js_core/lazy_load/lazy_load.js"),d=o("wkcommon:widget/lib/fis/data/data.js"),l=o("wkcommon:widget/lib/tangram/base/base.js"),c=o("wkcommon:widget/ui/js_core/log/log.js"),p=o("wkcommon:widget/ui/js_core/util/util.js"),r=t({Options:{id:null,width:750,height:null,isFullSize:!1,$el:$("#flow-ppt-wrap")},_init:function(){var o=this;o.tpl='<div class="mod flow-ppt-mod">\n<div class="bd ppt-bd">\n<%for (i = 0; i < ~~free; i++ ) {%>\n<%if (i < 3) {%>\n<div class="ppt-page-item ppt-bd reader-pageNo-<%=i+1%>">\n<div class="ppt-image-wrap">\n<img src="<%=list[i].zoom %>" alt="">\n</div>\n</div>\n<%} else {%>\n<div class="ppt-page-item reader-pageNo-<%=i+1%> ppt-bd hide hidden-doc-banner">\n<div class="ppt-image-wrap">\n<img data-src="<%=list[i].zoom %>" alt="">\n</div>\n</div>\n<%}%>\n<% } %>\n</div>\n</div>',o.data=new i(o.options.id)},_initEvents:function(){var o=this;o.showEl=!1,o.clickMore(),o.clickDownloadOrBuy(),o.clickJionVip(),$(window).scroll(p.debounce(o.showElLog,300,o)),l.lang.eventCenter.addEventListener("Reader.zoomChange",o.handleZoomAddEvent),$(".proDoc-download-js").on("click",function(){$(".pro-doc-download").trigger("click")})},clickMore:function(){var o=this;o.options.$el.on("click",".goBtn",function(){var e=o.options.$el;e.find(".ppt-page-item").show(),e.find("#doc_bottom_wrap").show(),e.find("#html-reader-go-more").hide(),$(window).trigger("scroll"),c.xsend(1,101464,{index:2})})},clickDownloadOrBuy:function(){var o=this,e=d.get("WkInfo").DocInfo||{};o.options.$el.on("click",".banner-down-btn",function(){1===e.isPaymentDoc&&1!==e.ispaied?$("body").find(".btn-payDoc").trigger("click"):$("body").find(".btn-download").trigger("click"),c.xsend(1,101466,{index:2})})},clickJionVip:function(){var o=this;o.options.$el.on("click",".btn-login-joinvip-rightnow-ppt",function(){var o=d.get("WkInfo").DocInfo||{},e=d.get("WkInfo").PageInfo.isLogin,n=$(this).parents(".middle-download-bottom-layout").length;e||l.lang.eventCenter.addEventListener("Login.Success",function(e){l.event.stop(e),c.xsend(1,101911),window.location.href="/cashier/browse/dispatch?dqStatCode=31_8_9_97&from_doc="+o.docId}),c.xsend(1,101537,{index:n}),c.xsend(1,100349),c.xsend(1,101911),window.location.href="/cashier/browse/dispatch?dqStatCode=31_8_9_97&from_doc="+o.docId})},showElLog:function(){var o=this,e=!1,n=!1,t=$(".btn-login-joinvip-rightnow-ppt",o.options.$el);0!==+t.length&&(e=t.eq(0).offset().top-$(document).scrollTop()>0&&$(window).height()-(t.eq(0).offset().top-$(document).scrollTop())>0,+t.length>1&&(n=t.eq(1).offset().top-$(document).scrollTop()>0&&$(window).height()-(t.eq(1).offset().top-$(document).scrollTop())>0),e&&!o.showEl&&(c.xsend(1,101536,{index:0}),o.showEl=!0),n&&!o.showEl&&(c.xsend(1,101536,{index:1}),o.showEl=!0),e||n||(o.showEl=!1))},getDocCountResponse:function(){l.lang.eventCenter.addEventListener("docCount.response",function(o){var e=o.data||{},n=[],t=0;e.qualityScore||e.float_valueAverage?(t=e.qualityScore?e.qualityScore:(e.float_valueAverage/2).toFixed(1),n.push('<b class="bannerScore"></b>'),t&&t>=4&&e.percentage?(n.push('<span class="high-quality">'+t+"\u5206</span>"),n.push('<span>(\u9ad8\u4e8e<span class="high-quality">'+e.percentage+"</span>%\u7684\u6587\u6863)</span>")):t&&t>=2&&e.percentage?(n.push('<span class="normal-quality">'+t+"\u5206</span>"),n.push('<span>(\u9ad8\u4e8e<span class="high-quality">'+e.percentage+"</span>%\u7684\u6587\u6863)</span>")):n.push('<span class="normal-quality">'+t+"\u5206</span>")):n.push("\u6682\u65e0\u8bc4\u4ef7"),$(".banner-more-info").append(n.join(""))})},handleZoomAddEvent:function(){var o=$(".high-quality-doc"),e=o.parent(),n=0===$("body").scrollTop()&&$("html").scrollTop()?"html":"body";o.css($(n).scrollTop()>280&&$(n).scrollTop()<e.height()+50?{position:"fixed",left:e.offset().left-3,top:80}:{position:"absolute",top:20,left:-3})},_render:function(){var o=this,e=d.get("WkInfo").DocInfo||{},n=d.get("WkInfo").PageInfo||{},t=0;t=e.vip_type&&e.is_discount_doc?~~e.vip_price/100:~~e.payPrice/100,o.on("onload",function(){o._getData()}),o.on("getDataAfter",function(e){var i=d.get("WkInfo").DocInfo||{};o.dataCache.docInfo=i,o.dataCache.pageInfo=n,o.dataCache.payPrice=t,o.dataCache.notVip=!(i.vip_type&&0!==+i.vip_type||i.jiaoyu_vip_type&&0!==+i.jiaoyu_vip_type||i.edu_vip_type&&0!==+i.edu_vip_type),o.dataCache.show={},o.dataCache.show.showVipdiversion=o.dataCache.notVip&&!i.isPaymentDoc;var c=a(o.tpl,o.dataCache);o.options.$el.html(c);var p=s.lazyLoad;new p,l.lang.eventCenter.dispatchEvent("FlowPPT.firstRender"),1===+i.professionalDoc?($(".ppt-page-item").removeClass("hide"),$("#doc_bottom_wrap").removeClass("hide")):e.free&&+e.free<4&&$("#doc_bottom_wrap").removeClass("hide")})},_getData:function(){var o=this,e=d.get("WkInfo").DocInfo||{},n=d.get("WkInfo").UserInfo||{},t=d.get("WkInfo").VipInfo||{};o.data.getData().done(function(i){i.count&&(o.dataCache=i,o.options.countPn=i.count,i.free=~~i.free,i.count=~~i.count,o.options.freeNum=i.free,i.flag=+t.flag,i.professionalDocDonwloadTicket=+t.professionalDocDonwloadTicket,i.smallFlowProfessionalDoc=+n.smallFlowProfessionalDoc,i.professionalDoc=+e.professionalDoc,o.fire("getDataAfter",i))})}});n.exports=r});
;define("wkview:widget/common_toc_reader/reader_ppt/tools.js",function(e,o,t){var a=e("wkcommon:widget/lib/tangram/base/base.js"),i=e("wkcommon:widget/ui/js_core/util/util.js"),n=e("wkcommon:widget/lib/fis/data/data.js"),r=e("wkview:widget/ui/html_view/widget.js").widget,s=e("wkview:widget/common_toc_toolbar/item/fullScreen/fullScreen.js").fullScreen,c=e("wkview:widget/common_toc_toolbar/item/zoom/zoom.js").zoom,l=e("wkview:widget/common_toc_toolbar/item/share/share.js").share,p=e("wkview:widget/common_toc_toolbar/item/appraise/appraise.js").appraise,w=e("wkview:widget/common_toc_toolbar/item/favo/favo.js").favo,d=e("wkview:widget/common_toc_toolbar/item/page/page.js").page,g=e("wkview:widget/common_toc_toolbar/item/wangpan/wangpan.js").wangpan,m=e("wkview:widget/common_toc_toolbar/item/coreBtns/coreBtns.js").coreBtns,u=e("wkview:widget/common_toc_toolbar/item/praise/praise.js").praise,f=e("wkview:widget/common_toc_toolbar/config.js").config,v=e("wkview:widget/common_item/setting/setting.js").setting,h=e("wkview:widget/ui/view/doc_share/doc_share.js"),_=e("wkview:widget/common_toc_toolbar/toolbar/toolbar.js").toolbar,b=e("wkcommon:widget/ui/lib/cookie/cookie.js"),k=0,P=n.get("WkInfo"),j=P.DocInfo||{},C=(P.UserInfo||{},r({Options:{el:".ppt-page-item",container:"#flow-ppt-wrap",readerContainer:{},totalPageNum:0,freePageNum:0},_init:function(){var e=this;e.totalPageNum=e.options.totalPageNum,e.el=$("#flow-ppt-wrap")[0],e.pageList=[],f.pageCount=e.options.freePageNum,f.doc_id=e.options.readerContainer&&e.options.readerContainer.data&&e.options.readerContainer.data.id,e.toolsBar=new _({readerContainer:e,reader:e.reader,items:e.getToolsBarItems()}),e.getPageByPosition(),e.updateCurrentPage(),e._renderDownload(),e.dealZoomOut(),e.shareDialog(),e.wangpanDialog(),e.resize(),i.windowResize(a.fn.bind(function(){a.lang.eventCenter.dispatchEvent("Reader.WindowResize")}))},dealZoomOut:function(){a.lang.eventCenter.addEventListener("Reader.zoomChange",function(){$(window).trigger("scroll")})},gotoPage:function(e){var o=$(".reader-pageNo-"+e),t=o.offset().top-20;window.scrollTo(0,t),v.currentPage=e},updateCurrentPage:function(){var e=this,o=i.debounce(function(){var o=$(window).scrollTop();o!==k&&(k=o,e.getPageByPosition(o))},100);$(window).on("scroll",o)},getPageByPosition:function(e){var o=this,t=$(window).scrollTop(),i=$(o.options.el).offset().top,n=0;this.createPagesTop(),e=e&&e-i+22||t-i+22;var r=this.pageTops.concat([]);r.push(e),r.sort(function(e,o){return o>e?-1:1});var s=a.array.indexOf(r,e),c=$("#html-reader-go-more").css("display");0>=s?s=1:"block"===c&&s>=3&&(s=3),n=Math.min(s,o.totalPageNum),+v.currentPage!==+n&&(v.currentPage=n),a.lang.eventCenter.dispatchEvent("Reader.scroll",{currentPage:v.currentPage})},createPagesTop:function(){for(var e=this,o=$(e.options.el+":visible"),t=[],a=$(e.options.container).offset().top,i=0;i<o.length;i++)t.push(o.eq(i).offset().top-a);e.pageList=o,e.pageTops=t},_renderDownload:function(){$(".down-doc-new").css("display","inline-block"),$("#ft-down-area").css("display","inline-block")},getToolsBarItems:function(){var e=this,o=[];return o="1"===j.can_dump?[s,c,u,w,p,e.isPrivate?null:l,g,d,m]:[s,c,u,w,p,e.isPrivate?null:l,d,m]},shareDialog:function(){var e=6===a.browser.ie||7===a.browser.ie;if(!e){var o=new l;o.loadData(),$(".ui-toolbar-left").append(o.$el[0]),f.shareElId="shareMore-ppt";var t=h.shareToCreate({el:a.dom.q("reader-tools-share")[0],view:"viewReader-ppt",copy:"copyCode-ppt",panel:"panel-ppt",closePanel:"closePanel-ppt",toggleSize:["normalSize-ppt","bigSize-ppt"],codeText:"readerCode-ppt",copyResult:"copyResult-ppt"});t.show()}},wangpanDialog:function(){b.get("wangpanTipShow")||$(".wangpan-tip").show(),$(document).on("click",".wangpan-tip .btn-close",function(){$(".wangpan-tip").hide(),b.set("wangpanTipShow",1,{expires:864e5})})},resize:function(){var e=this;e.toolsBar.resize({readerWidth:e.el.offsetWidth,bodyElWidth:a.dom.query(f.bodySelector)[0].offsetWidth})}}));t.exports=C});
;define("wkview:widget/common_toc_reader/reader_ppt/log.js",function(e,t,o){var n=e("wkcommon:widget/ui/js_core/log/log.js"),i=e("wkcommon:widget/lib/tangram/base/base.js"),r=e("wkview:widget/common_item/setting/setting.js").setting;o.exports={run:function(){i.lang.eventCenter.addEventListener("flowpptLog.showDownBtn",function(e,t){i.dom.ready(function(){var e=!1;if(t.$item&&t.actId&&t.index&&0!==t.$item.length){var o=t.$item,i=function(){var i=o.offset().top,d=o.height(),w=$(window).height(),a=$(window).scrollTop();if(a+w>=i+d){if(e||n.xsend(1,t.actId,{index:t.index}),r.isFullScreen&&$("#flow-ppt-wrap").length&&$("#doc_reader").length){var g=$("#flow-ppt-wrap").height()-$("#doc_reader").offset().top;$(".reader-placeholder").height(g)}e=!0}};$(window).on("scroll.flowpptShowLog",i)}})})}}});
;define("wkview:widget/common_toc_reader/reader_ppt/index.js",function(e,t,i){var o=e("wkcommon:widget/lib/tangram/base/base.js"),n=e("wkcommon:widget/lib/fis/data/data.js"),r=e("wkview:widget/ui/html_view/widget.js").widget,d=e("wkview:widget/common_toc_reader/reader_ppt/flowppt/flowppt.js"),w=e("wkview:widget/common_item/autofixed/autofixed.js").autofixed,a=e("wkview:widget/model/vipData.js"),p=e("wkview:widget/common_toc_reader/reader_ppt/tools.js"),s=e("wkview:widget/common_toc_reader/reader_ppt/log.js"),l=r({Options:{id:null,width:750,height:null,isFullSize:!1},_init:function(){$("body").addClass("flowPPt");var e=this,t=n.get("WkInfo").DocInfo;e.isPrivate=t.isPrivate||!1,s.run(),this.flowppt=new d({el:e.options.pptEl,id:e.options.id,width:e.options.width,payprice:~~t.payPrice/100}),o.lang.eventCenter.addEventListener("FlowPPT.firstRender",function(){a.run($.proxy(e.render,e),$.proxy(e.render,e)),o.lang.eventCenter.dispatchEvent("flowpptLog.showDownBtn",{$item:$(".banner-down-btn"),actId:101466,index:1})})},render:function(){var e=this,t=e.flowppt||{};e.tools=new p({readerContainer:t,totalPageNum:t.options.countPn,freePageNum:t.options.freeNum})}},{type:"PPT"});(!o.browser.ie||o.browser.ie>7)&&new w({el:o.g("fixed-box")}),i.exports=l});