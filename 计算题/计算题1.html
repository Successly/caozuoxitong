<!DOCTYPE html>
<!-- saved from url=(0178)http://view51.book118.com/?readpage=U6JrwkAN7PByOE1S9ra4Lw==&furl=o4j9ZG7fK94ywCJ0aQkdUad3YkM4Kc1@bPc_5q6yqfMcdR5aGeBGGGWqkR0JdKkNZ6lDx5GGJMqWxzrBiwLTbtaZXFyrAb535erXw5xIMRo=&n=1 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2137252-59461a8b20ee3</title>
    <style type="text/css">
        body { margin: 0; overflow-x: hidden; background-color: #E6E6E6; font-family: Microsoft YaHei; font-size: 14px; }
        .split { float: left; width: 1px; height: 18px; background-color: rgba(0, 0, 0, 0.5); box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.08); margin: 10px 3px }
        .tool { float: left; width: 32px; height: 32px; background: url("Content/img/tools.png?v=3.1"); background-repeat: no-repeat; }
        .bdr { border: 1px solid #4e4e4e; cursor: default; }
            .bdr:hover { background-color: #5a5a5a }
            .bdr:active { background-color: #787878 }
        .pgpan { line-height: 32px; font-size: 1em; border-top: 1px solid #898989; }
        .pgdiv { line-height: 32px; font-size: 0.86em; }
            .pgdiv:hover { background-color: #828282; }
    </style>
    
</head>
<body ondragstart="return false" onselectstart="return false" style="cursor:pointer;-moz-user-select: none;user-select:none;margin:0" oncontextmenu="return false">
    <div id="msg" style="position:absolute"></div>
    <!--[if lt IE 9]><input id="isIE8" type="hidden" autocomplete="off" /><![endif]-->
    <div name="parms">
        <input type="hidden" id="Url" value="RTpcT2ZmaWNlV2ViMzY1XE9mZmljZVdlYlxjYWNoZVxQREZcMTE3MDYxODE0MTUzOTEyNzAwMjEwMTM5NzNfMTU2MTYwXDIxMzcyNTItNTk0NjFhOGIyMGVlMy5kb2MudGVtcA==" autocomplete="off">
        <input type="hidden" id="IsMobi" value="false" autocomplete="off">
        <input type="hidden" id="ViewPath" value="img" autocomplete="off">
        <input type="hidden" id="Furl" value="o4j9ZG7fK94ywCJ0aQkdUad3YkM4Kc1@bPc_5q6yqfMcdR5aGeBGGGWqkR0JdKkNZ6lDx5GGJMqWxzrBiwLTbtaZXFyrAb535erXw5xIMRo=" autocomplete="off">
        <input type="hidden" id="ReadLimit" value="U6JrwkAN7PByOE1S9ra4Lw==" autocomplete="off">
        <input type="hidden" id="Tp" value="" autocomplete="off">
    </div>
    <div id="scaleMsg" style="position:absolute;margin-top:40px;width:120px;display:none;opacity:0.8;color:#262626;margin-left:5px;z-index:19830112;text-shadow:#FFF 1px 0 0,#FFF 0 1px 0,#FFF -1px 0 0,#FFF 0 -1px 0;font-size:15px">缩放：100%</div>
    <div style="background:#4e4e4e;text-align:center;height:36px;position:absolute;z-index:1000000;width:100%;top:0">
        <div style="border:1px solid #4e4e4e;width:86px;height:32px;position:absolute;margin-left:5px;margin-top:0px;left:0">
            <div id="addBtn" style="background-position: 0px 0px;" class="tool bdr"></div>
            <div style="" class="split"></div>
            <div id="subBtn" style="background-position: 0px -32px;" class="tool bdr"></div>
        </div>
        <div id="pageBtn" style="width:106px;height:32px;margin:auto;font-size:14px;line-height:36px;color:#FFF;" class="bdr">
            <div id="pageIndex" style="float:left;width:36px;text-align:right;">1</div>
            <div style="float:left;width:20px;text-align:center">/</div>
            <div id="pageCount" style="float:left;width:36px;text-align:left">6</div>
            <div id="waitmsg" class="waitmsg" style="display:none">
                <div style="opacity:0.9;font-size:16px;line-height:49px;text-align:center;z-index:888888;color:#FFF;text-shadow: #000 1px 0 0,#000 0 1px 0,#000 -1px 0 0,#000 0 -1px 0;">正在加载</div>
                <div style="opacity:0.5;background:#767676;border-radius:3px;z-index:888886"></div>
            </div>
        </div>
        <div id="recordDiv" onclick="javascript:this.style.display=&#39;none&#39;" style="text-align:center;width:236px;left:50%; margin-left:-118px;height:98px;margin-top:60px;position:absolute;font-size:18px;display:none">
            <div style="position:absolute;line-height:36px;z-index:100000001;margin-top:18px">
                <div style="color:#FFF;width:236px"><span>记录您上次看到第</span> <span id="recordIdx"></span> <span>页</span></div>
                <div style="color:#DA7831;width:100px;margin:auto;cursor:pointer" onclick="goPage(0)">从头开始</div>
            </div>
            <div style="background-color:#000;position:absolute;width:236px;height:98px;opacity:0.7;filter:Alpha(opacity=70);border-radius:3px;z-index:100000000"></div>
        </div>
        <div style="border:1px solid #4e4e4e;width:86px;height:32px;position:absolute;margin-top:-34px;right:-6px">
            <div id="preBtn" style="background-position: -1px -127px;" class="tool bdr"></div>
            <div style="" class="split"></div>
            <div id="nextBtn" style="background-position: -1px -161px;" class="tool bdr"></div>
        </div>
    </div>
    <div id="pageInfo" style="position: absolute; width: 106px; margin-top: 36px; z-index: 10088; text-align: center; background: rgb(78, 78, 78); color: rgb(255, 255, 255); overflow-y: scroll; font-size: 14px; display: none; margin-left: 630px; max-height: 553px;"><div id="pg0"><div class="pgpan"></div><div><div data-index="0" class="pgdiv">第1页</div><div data-index="1" class="pgdiv">第2页</div><div data-index="2" class="pgdiv">第3页</div><div data-index="3" class="pgdiv">第4页</div><div data-index="4" class="pgdiv">第5页</div><div data-index="5" class="pgdiv">第6页</div></div></div></div>
    <div id="preMsg" style="width:10px;height:80px;position:absolute;margin-top:180px;margin-left:26px;font-size:12px;color:#dcdcdc">上一页</div>
    <div id="nextMsg" style="width:10px;height:80px;position:absolute;margin-top:180px;right:26px;font-size:12px;color:#dcdcdc">下一页</div>
    <div id="ctn" data-scale="100" style="margin-top: 36px; width: 1366px; margin-left: 0px; overflow-x: hidden; overflow-y: scroll; position: absolute; height: 577px;"><div id="p0" data-page="7o@o7xcocmlUWk5DuuIAtfyQ3F5YsYUNTN@kcp1UD4xRPR0mW82tvHgSH6y33ImBQkgxKTF1Muk=" data-width="792" data-height="1120" style="margin: auto auto 10px; width: 792px; height: 1120px;"><img src="./计算题1_files/img" style="position: absolute; width: 792px; height: 1120px;"><div style="position: absolute; width: 792px; height: 1120px;"></div></div><div id="p1" data-page="7o@o7xcocmlUWk5DuuIAtfyQ3F5YsYUNTN@kcp1UD4xRPR0mW82tvGyZ4OQAKg0OduUHH4BU8kA=" data-width="792" data-height="1120" style="margin: auto auto 10px; width: 792px; height: 1120px;"><img src="./计算题1_files/img(1)" style="position: absolute; width: 792px; height: 1120px;"><div style="position: absolute; width: 792px; height: 1120px;"></div></div><div id="p2" data-page="7o@o7xcocmlUWk5DuuIAtfyQ3F5YsYUNTN@kcp1UD4xRPR0mW82tvCUs_zkqzC4DEQZwR2WDR2I=" data-width="792" data-height="1120" style="margin: auto auto 10px; width: 792px; height: 1120px;"><img src="./计算题1_files/img(2)" style="position: absolute; width: 792px; height: 1120px;"><div style="position: absolute; width: 792px; height: 1120px;"></div></div><div id="p3" data-page="7o@o7xcocmlUWk5DuuIAtfyQ3F5YsYUNTN@kcp1UD4xRPR0mW82tvBmrO5vdms8KT3wuIgEHmIE=" data-width="792" data-height="1120" style="margin: auto auto 10px; width: 792px; height: 1120px;"><img src="./计算题1_files/img(3)" style="position: absolute; width: 792px; height: 1120px;"><div style="position: absolute; width: 792px; height: 1120px;"></div></div><div id="p4" data-page="7o@o7xcocmlUWk5DuuIAtfyQ3F5YsYUNTN@kcp1UD4xRPR0mW82tvDP2MSmdkRa7IM7@juvP6U4=" data-width="792" data-height="1120" style="margin: auto auto 10px; width: 792px; height: 1120px;"><img src="./计算题1_files/img(4)" style="position: absolute; width: 792px; height: 1120px;"><div style="position: absolute; width: 792px; height: 1120px;"></div></div></div>


<script type="text/javascript">
    if (typeof JSON !== "object") { JSON = {} } (function () { "use strict"; var rx_one = /^[\],:{}\s]*$/; var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g; var rx_three = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g; var rx_four = /(?:^|:|,)(?:\s*\[)+/g; var rx_escapable = /[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g; var rx_dangerous = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g; function f(n) { return (n < 10) ? "0" + n : n } function this_value() { return this.valueOf() } if (typeof Date.prototype.toJSON !== "function") { Date.prototype.toJSON = function () { return isFinite(this.valueOf()) ? (this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z") : null }; Boolean.prototype.toJSON = this_value; Number.prototype.toJSON = this_value; String.prototype.toJSON = this_value } var gap; var indent; var meta; var rep; function quote(string) { rx_escapable.lastIndex = 0; return rx_escapable.test(string) ? "\"" + string.replace(rx_escapable, function (a) { var c = meta[a]; return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4) }) + "\"" : "\"" + string + "\"" } function str(key, holder) { var i; var k; var v; var length; var mind = gap; var partial; var value = holder[key]; if (value && typeof value === "object" && typeof value.toJSON === "function") { value = value.toJSON(key) } if (typeof rep === "function") { value = rep.call(holder, key, value) } switch (typeof value) { case "string": return quote(value); case "number": return (isFinite(value)) ? String(value) : "null"; case "boolean": case "null": return String(value); case "object": if (!value) { return "null" } gap += indent; partial = []; if (Object.prototype.toString.apply(value) === "[object Array]") { length = value.length; for (i = 0; i < length; i += 1) { partial[i] = str(i, value) || "null" } v = partial.length === 0 ? "[]" : gap ? ("[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]") : "[" + partial.join(",") + "]"; gap = mind; return v } if (rep && typeof rep === "object") { length = rep.length; for (i = 0; i < length; i += 1) { if (typeof rep[i] === "string") { k = rep[i]; v = str(k, value); if (v) { partial.push(quote(k) + ((gap) ? ": " : ":") + v) } } } } else { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = str(k, value); if (v) { partial.push(quote(k) + ((gap) ? ": " : ":") + v) } } } } v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}"; gap = mind; return v } } if (typeof JSON.stringify !== "function") { meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", "\"": "\\\"", "\\": "\\\\" }; JSON.stringify = function (value, replacer, space) { var i; gap = ""; indent = ""; if (typeof space === "number") { for (i = 0; i < space; i += 1) { indent += " " } } else if (typeof space === "string") { indent = space } rep = replacer; if (replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) { throw new Error("JSON.stringify"); } return str("", { "": value }) } } if (typeof JSON.parse !== "function") { JSON.parse = function (text, reviver) { var j; function walk(holder, key) { var k; var v; var value = holder[key]; if (value && typeof value === "object") { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = walk(value, k); if (v !== undefined) { value[k] = v } else { delete value[k] } } } } return reviver.call(holder, key, value) } text = String(text); rx_dangerous.lastIndex = 0; if (rx_dangerous.test(text)) { text = text.replace(rx_dangerous, function (a) { return ("\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)) }) } if (rx_one.test(text.replace(rx_two, "@").replace(rx_three, "]").replace(rx_four, ""))) { j = eval("(" + text + ")"); return (typeof reviver === "function") ? walk({ "": j }, "") : j } throw new SyntaxError("JSON.parse"); } } }());
</script>
<script type="text/javascript">
    function $id(id) { return document.getElementById(id); }
    var isIE8 = ($id("isIE8") != null); var turnLock = -1; var endLoop = { idx: 0, count: 0, max: 10 }
    function goPage(idx) {
        if (typeof (idx) == "object") { idx = parseInt(idx.getAttribute("data-index")); } else { idx = parseInt(idx); }
        $id("pageInfo").style.display = "none"; var nowIdx = parseInt($id("pageIndex").innerHTML) - 1; if (idx == nowIdx) { return false; }
        if (!recall.paged) { if (idx > recall.snAlrdy && idx - nowIdx > 1) { waitOnMsg("不允许跳页"); return false; } }
        $id("pageIndex").innerHTML = idx + 1; var toPage = $id("p" + idx); if (toPage != null) { $id("ctn").scrollTop = toPage.offsetTop; } else { turnLock = idx; setTimeout(function () { setScroll("p" + idx, 0); }, 200); }
        pageEnter(idx, nowIdx); getData(idx);
    }
    function nextPage() { $id("nextBtn").click(); }
    function prePage() { $id("preBtn").click(); }
    function pageEnter(idx, from) { if (from < 0) { window.MobiReport(); } else { window.recallTo(from, false); } }
    var hanled = false; function userLeave() {
        if (hanled) { return; }
        hanled = true; if (recall.record) { var idx = parseInt($id("pageIndex").innerHTML) - 1; window.recallTo(idx, true); }
    }
    window.onbeforeunload = userLeave; if (!isIE8) { window.addEventListener('message', function (event) { var tp = event.data.split(","); switch (tp[0]) { case "goPage": goPage(parseInt(tp[1])); break; case "nextPage": nextPage(); break; case "prePage": prePage(); break; } }); document.body.addEventListener('touchmove', function (e) { e.preventDefault() }, { passive: false }); }
    document.onkeydown = function (event) { event = event || window.event; switch (event.keyCode) { case 37: case 33: prePage(); break; case 38: break; case 39: case 34: nextPage(); break; case 32: nextPage(); break; break; } }; function setScroll(id, count) {
        var toPage = $id(id); if (toPage != null) { $id("ctn").scrollTop = toPage.offsetTop; return true; }
        if (count < 50) { setTimeout(function () { setScroll(id, count + 1); }, 100); }
    }
    function unLock() { turnLock = -1; }
    $id("ctn").onmousewheel = unLock; if (!isIE8) { $id("ctn").addEventListener("DOMMouseScroll", unLock); }
    String.prototype.endWith = function (oString) { var reg = new RegExp(oString + "$"); return reg.test(this); }
    Math.sign = function (num) { if (num > 0) { return 1; } else if (num < 0) { return -1; } else { return 0; } }
    var isNext = true; var isInDrag = false; !function () {
        var dp; var idx = 0; if ($id("proc") == null) { initGet(); } else { if ($id("proc").getAttribute("data-value") == "100") { toload(); initGet(); } else { setTimeout(function () { dp = setInterval("getProc()", 300); }, 100); $id("proc").style.display = "block"; } }
        function load(v) {
            if (isNaN(v)) { document.writeln(v); clearInterval(dp); }
            var proc = $id("proc"); var preVal = parseInt(proc.getAttribute("data-value")); if (v == 0 && preVal < 6) { v = v + 2; }
            proc.style.width = v + "%"; if (v == 100) { clearInterval(dp); toload(); initGet(); proc.style.display = "none"; } else if (v > preVal) { proc.setAttribute("data-value", v); idx--; }
            idx++;
        }
        window.getProc = function () {
            if (idx > 100) { clearInterval(dp); }
            var xmlhttp; if (window.XMLHttpRequest) { xmlhttp = new XMLHttpRequest(); } else { xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 1) { }
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) { load(xmlhttp.responseText); } else { idx++; }
            }; var enfurl = "?furl=" + encodeURIComponent(location.search.substring(location.search.indexOf("furl=") + 5)) + "&" + location.search.substring(1); xmlhttp.open("GET", "default/GetProc" + enfurl, false); xmlhttp.send();
        }
        function toload() { setTimeout(function () { var ld = $id("loading0"); if (ld != null) { ld.style.display = "block"; } }, 100); }
    }(); var evtName = { start: "touchstart", move: "touchmove", end: "touchend" }
    { if (!("ontouchstart" in window)) { evtName.start = "mousedown"; evtName.move = "mousemove"; evtName.end = "mouseup"; } }
    function ev(event, ismobile) { if (ismobile) { return event.touches[0]; } else { return event || window.event; } }
    function getWinSz(w) { if (w) { return window.innerWidth || document.documentElement.clientWidth; } else { return window.innerHeight || document.documentElement.clientHeight; } }
    var pageSpc = 10; !function () {
        var onSlide = false; var mPos = { x: 0, y: 0, initY: 0, w: 0, mL: 0, tm: null, id: null }; var ismobile = ("ontouchstart" in window); if (isIE8) { $id("ctn").onmousedown = touchStart; $id("ctn").onmousemove = touchMove; $id("ctn").onmouseup = touchEnd; } else { $id("ctn").addEventListener(evtName.start, touchStart, false); $id("ctn").addEventListener(evtName.move, touchMove, false); $id("ctn").addEventListener(evtName.end, touchEnd, false); }
        function touchStart(event) {
            $id("pageInfo").style.display = "none"; if (isInDrag) { onSlide = false; return false; }
            var nowIdx = parseInt($id("pageIndex").innerHTML); mPos.id = $id("p" + (nowIdx - 1)); if (mPos.id == null) { onSlide = false; return false; }
            onSlide = true; var touch = ev(event, ismobile); mPos.x = touch.clientX; mPos.y = touch.clientY; mPos.initY = mPos.y; var winW = getWinSz(true); var pageW = parseInt(mPos.id.style.width); mPos.mL = (winW - pageW) / 2; mPos.w = winW / 3; mPos.tm = (new Date()).getTime(); turnLock = -1;
        }
        function touchMove(event) {
            if (isInDrag) { return false; }
            if (onSlide) { var touch = ev(event, ismobile); var tchX = touch.clientX; var offX = (tchX - mPos.x); var tchY = touch.clientY; var offY = (tchY - mPos.y); $id("ctn").scrollLeft = $id("ctn").scrollLeft - offX; $id("ctn").scrollTop = $id("ctn").scrollTop - offY;; mPos.x = tchX; mPos.y = tchY; }
        }
        function touchEnd() {
            onSlide = false; if (isInDrag) { return false; }
            var tmElapsed = (new Date()).getTime() - mPos.tm; var yOff = mPos.y - mPos.initY; var yOffAbs = Math.abs(yOff); var speed = yOffAbs * 100 / tmElapsed; var fixVal = (yOffAbs > 200 ? 150 : 100); if (speed > fixVal) { tmScroll(Math.ceil(yOffAbs / 10) * 3, Math.ceil(speed / 10 * 2), (1000 - speed) / 100, Math.sign(yOff)); }
        }
        function tmScroll(step, count, time, sign) {
            if (count < 1) { return; }
            $id("ctn").scrollTop = $id("ctn").scrollTop - sign * step; setTimeout(function () { tmScroll(step * 0.9, count - 1, time, sign); }, time);
        }
        function preNext() { var nowIdx = parseInt($id("pageIndex").innerHTML) - 1; var toIdx = getIndex(); if (toIdx != nowIdx) { if (turnLock > -1) { $id("pageIndex").innerHTML = turnLock + 1; pageEnter(turnLock, nowIdx); } else { $id("pageIndex").innerHTML = toIdx + 1; pageEnter(toIdx, nowIdx); getData(toIdx); } } }
        $id("preBtn").onclick = function () {
            var nowIdx = parseInt($id("pageIndex").innerHTML) - 1; if (nowIdx <= 0) { return false; }
            var toPage = $id("p" + (nowIdx - 1)); if (toPage != null) { $id("ctn").scrollTop = toPage.offsetTop; } else { turnLock = true; setTimeout(function () { setScroll("p" + (nowIdx - 1), 0); }, 200); }
            isNext = false; turnLock = -1; preNext();
        }
        $id("nextBtn").onclick = function () {
            var nowIdx = parseInt($id("pageIndex").innerHTML) - 1; var pgCount = parseInt($id("pageCount").innerHTML); if ((nowIdx + 1) >= pgCount) { return false; }
            var toPage = $id("p" + (nowIdx + 1)); if (toPage != null) { $id("ctn").scrollTop = toPage.offsetTop; } else { turnLock = true; setTimeout(function () { setScroll("p" + (nowIdx + 1), 0); }, 200); }
            turnLock = -1; preNext();
        }
        var scrollPre = 0; $id("ctn").onscroll = function () {
            if (turnLock > -1) { return false; }
            var thisTop = this.scrollTop; isNext = (scrollPre <= thisTop); preNext(); scrollPre = thisTop;
        }
        function getIndex() {
            var ctn = $id("ctn"); var scrollTop = ctn.scrollTop; var start = Math.floor(scrollTop / ctn.firstChild.clientHeight / 2); if (scrollTop < ctn.firstChild.clientHeight * 3 / 4) { return getIdx(ctn.firstChild); }
            for (var i = start + 1; i < ctn.childNodes.length; i++) { if (ctn.childNodes[i].offsetTop > scrollTop) { var pos34 = ctn.childNodes[i - 1].offsetTop + ctn.childNodes[i - 1].clientHeight * 3 / 4; if (scrollTop < pos34) { return getIdx(ctn.childNodes[i - 1]); } else { return getIdx(ctn.childNodes[i]); } } }
            return getIdx(ctn.lastChild);
        }
        function getIdx(pg) { return parseInt(pg.id.replace("p", "")); }
    }(); function getML(pageW) { var winW = getWinSz(true); return (winW - parseFloat(pageW)) / 2; }
    var animList = []; function anim(c, css, to, px, tm, ov) { var frm = parseFloat(c.style[css]); var count = tm / 20; var step = (to - frm) / count; var i = 0; var itv = window.setInterval(function () { c.style[css] = (frm + i * step) + px; i++; if (i > count) { clearInterval(itv); animList.remove(c); if (ov != undefined) { for (var p in ov) { c.style[p] = ov[p]; } } } }, 20); var animQue = { id: c, itv: itv }; animList.push(animQue); }
    animList.remove = function (c) { for (var i = 0; i < animList.length; i++) { if (animList[i].id == c) { animList.splice(i, 1); break; } } }
    animList.contain = function (c) {
        for (var i = 0; i < animList.length; i++) { if (animList[i].id == c) { return animList[i]; } }
        return false;
    }
    function getParm(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); var r = window.location.search.substr(1).match(reg); if (r != null)
            return unescape(r[2]); return null;
    }
    function init() {
        resizeWin(); var sn = parseInt(getParm("sn")); if (sn > 0) { $id("recordIdx").innerHTML = sn + 1; $id("recordDiv").style.display = "block"; setTimeout(function () { $id("recordDiv").style.display = "none"; }, 3000); }
        $id("pageBtn").onmousedown = function () { var pgInfo = $id("pageInfo"); if (pgInfo.style.display == "none") { pgInfo.style.display = "block"; setPageInShow(); } else { pgInfo.style.display = "none"; } }
    }
    init(); window.onresize = resizeWin; function resizeWin() {
        var w0 = getWinSz(true); var h0 = getWinSz(false); $id("ctn").style.width = w0 + "px"; $id("ctn").style.height = (h0 - 36) + "px"; $id("pageInfo").style.marginLeft = (w0 / 2 - 53) + "px"; $id("pageInfo").style.maxHeight = (h0 - 60) + "px"; var scale = parseInt($id("ctn").getAttribute("data-scale")); if (scale == 100) {
            var pages = $id("ctn").childNodes; for (var i = 0; i < pages.length; i++) {
                var pgw = parseFloat(pages[i].style.width); var origW = parseFloat(pages[i].getAttribute("data-width")); if (pgw < origW || w0 < origW) {
                    if (w0 > origW) { w0 = origW; }
                    var toSize = { width: w0 + "px", height: "" }; pages[i].style.width = toSize.width; var origH = parseFloat(pages[i].getAttribute("data-height")); toSize.height = origH * getZoom(origW, w0) + "px"; pages[i].style.height = toSize.height; var eles = pages[i].childNodes; for (var j = 0; j < eles.length; j++) { eles[j].style.width = toSize.width; eles[j].style.height = toSize.height; }
                }
            }
        }
    }
    function getZoom(val, toval) { return parseFloat(toval) / parseFloat(val); }
    var nowReq = -1; function getHtml(pagedata, sn, preRdy, first) {
        if (pagedata == "Error") { return false; }
        if (sn == undefined) { sn = parseInt($id("pageIndex").innerHTML) - 1; } else { var count = parseInt($id("pageCount").innerHTML); if (count > 0 && sn >= count) { return false; } }
        if (sn == nowReq) { return false; }
        var xmlhttp; if (window.XMLHttpRequest) { xmlhttp = new XMLHttpRequest(); } else { xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); }
        xmlhttp.onreadystatechange = function () { if (xmlhttp.readyState == 4 && xmlhttp.status == 200) { nowReq = -1; var data = JSON.parse(xmlhttp.responseText); setData(data, preRdy); if (first) { pageEnter(data.PageIndex - 1, -1); } } else { } }; var enfurl; if ($id("VID") != null) { enfurl = "?f=" + $id("Url").value + "&img=" + pagedata + "&isMobile=" + $id("IsMobi").value + "&vid=" + $id("VID").value + "&dk=" + $id("Dk").value + "&ver=" + $id("Ver").value + "&sn=" + sn; } else { enfurl = "?f=" + $id("Url").value + "&img=" + pagedata + "&isMobile=" + $id("IsMobi").value + "&readLimit=" + $id("ReadLimit").value + "&sn=" + sn + "&furl=" + $id("Furl").value; }
        xmlhttp.open("GET", pathName() + "/GetPage" + enfurl, true); xmlhttp.send(); nowReq = sn;
    }
    function pathName() {
        var pn = window.location.pathname.toLowerCase(); if (pn.endWith("/")) { pn = pn.substr(0, pn.length - 1); }
        return pn + "/PW";
    }
    function initGet() { var startIdx = parseInt($id("pageIndex").innerHTML) - 1; getData(startIdx, true); }
    var maxIdx = 10000; function getData(startIdx, first) {
        if (startIdx == endLoop.idx) {
            if (endLoop.count > endLoop.max) { return false; }
            endLoop.count++;
        } else { endLoop.idx = startIdx; endLoop.count = 0; }
        if (startIdx > maxIdx) { return false; }
        if (isNext) {
            var count = parseInt($id("pageCount").innerHTML); if (count == 0) { count = startIdx + 1; }
            var nowIdx = parseInt($id("pageIndex").innerHTML) - 1; var toIdx = nowIdx + 5; if (toIdx > count) { toIdx = count; }
            for (var i = startIdx; i < toIdx; i++) {
                var findEle = $id("p" + i); if (findEle == null) {
                    var preEle = $id("p" + (i - 1)); if (preEle != null) { if (isOver(preEle)) { break; } }
                    var pre = $id("p" + (i - 1)); var pageData = ""; if (pre != null) { pageData = pre.getAttribute("data-page"); }
                    getHtml(pageData, i, false, first); break;
                } else { if (isOver(findEle)) { break; } }
            }
        } else {
            var toIdx = parseInt($id("pageIndex").innerHTML) - 1 - 5; if (toIdx < 0) { toIdx == 0; }
            for (var i = startIdx; i > -1; i--) {
                var findEle = $id("p" + i); if (findEle == null) {
                    var pre = $id("p" + (i - 1)); var pageData = ""; if (pre != null) {
                        if (isOver(pre)) { continue; }
                        pageData = pre.getAttribute("data-page");
                    }
                    getHtml(pageData, i, false); break;
                }
            }
        }
    }
    function isOver(ele) { if (ele.getAttribute("data-page") == "ReadLimit") { return true; } else { return false; } }
    function setData(data, preRdy) {
        if (data.PageIndex == null) { return false; }
        var ctn = $id("ctn"); var sn = data.PageIndex - 1; var nowIdx = parseInt($id("pageIndex").innerHTML) - 1; if ($id("pageCount").innerHTML == "0") { $id("pageCount").innerHTML = data.PageCount; setPage(data.PageCount, nowIdx); }
        if ($id("p" + sn) == null) {
            var w0 = getWinSz(true); var h0 = getWinSz(false); var w1 = parseInt(data.Width); var h1 = parseInt(data.Height); if (w1 > w0) { var temp = w1; w1 = w0; h1 = h1 * w0 / temp; }
            var scale = parseFloat($id("ctn").getAttribute("data-scale")) / 100; w1 = w1 * scale; h1 = h1 * scale; var px = document.createElement("div"); px.id = "p" + sn; px.onclick = "return false"; px.ondblclick = function (event) { event = event || window.event; var pos = { x: event.clientX, y: event.clientY }; var scale = parseInt($id("ctn").getAttribute("data-scale")); if (scale == 100) { scalePage(40, pos); } else { scalePage(100 - scale, pos); } }
            px.setAttribute("data-page", data.NextPage); px.setAttribute("data-width", data.Width); px.setAttribute("data-height", data.Height); setCss(px, { margin: "auto", marginBottom: pageSpc + "px", width: w1 + "px", height: h1 + "px" }); if (data.PageIndex == data.PageCount) { px.style.marginBottom = (h0 * 2 / 3) + "px"; }
            var isOver = !0; switch (data.NextPage) { case "!": return false; case "Over": setCss(px, { width: (w0 - 2) + "px", height: (h0 - 100) + "px" }); px.innerHTML = "<div style='text-align:center;margin:30px auto 100px auto'>超出页面范围</div>"; break; case "Error": setCss(px, { width: (w0 - 2) + "px", height: (h0 - 100) + "px" }); px.innerHTML = "<div style='text-align:center;margin:30px auto 100px auto'>该页错误，请重新打开</div>"; break; case "Response": location.href = data.ErrorMsg; return false; case "ReadLimit": setCss(px, { width: (w0 - 2) + "px", height: (h0 - 100) + "px" }); maxIdx = data.PageIndex; px.innerHTML = "<div style='text-align:center;margin:30px auto 100px auto'>只能查看 " + data.ErrorMsg + " 页</div>"; break; default: var img = document.createElement("img"); img.onclick = "return false"; setCss(img, { position: "absolute", width: w1 + "px", height: h1 + "px" }); img.src = $id("ViewPath").value + "?img=" + data.NextPage + "&tp=" + encodeURIComponent($id("Tp").value); px.appendChild(img); isOver = !1; break; }
            var mask = document.createElement("div"); setCss(mask, { position: "absolute", width: w1 + "px", height: h1 + "px" }); px.appendChild(mask); var lastEle = getLastEle(ctn); if (lastEle == null) { ctn.appendChild(px); } else {
                var lastId = parseInt(lastEle.id.replace("p", "")); if (sn > lastId) { ctn.appendChild(px); } else {
                    var beforeEle = getBefore(lastEle, sn); var nowScrollTop = ctn.scrollTop; var scrH = ctn.scrollHeight; ctn.insertBefore(px, beforeEle); if (preRdy || !isNext) {
                        if (nowScrollTop == ctn.scrollTop) { ctn.scrollTop += (ctn.scrollHeight - scrH); }
                        ctn.scrollTop += 0.1; isNext = true;
                    }
                }
            }
        }
        if (!isOver && !preRdy) {
            var count = parseInt($id("pageCount").innerHTML); if (isNext) {
                var pre1 = true; if (data.PageIndex < count && data.PageIndex < nowIdx + 5) { if ($id("p" + data.PageIndex) == null) { pre1 = false; getData(data.PageIndex); } }
                if (pre1) { if (nowIdx > 0 && $id("p" + (nowIdx - 1)) == null) { getHtml("", nowIdx - 1, true); } }
            } else { if (data.PageIndex > 1 && data.PageIndex > nowIdx - 5) { getData(data.PageIndex - 1); } }
        }
    }
    function setPage(pageCount, nowIdx) {
        var where = Math.floor(nowIdx / 10); var pcCount = Math.ceil(pageCount / 10); for (var i = 0; i < pcCount; i++) {
            var pc = document.createElement("div"); pc.id = "pg" + i; var pcText = document.createElement("div"); if (pageCount > 10) { pcText.innerHTML = (i * 10 + 1) + "-" + (i + 1) * 10 + "页"; }
            pcText.className = "pgpan"; pc.appendChild(pcText); pcText.onclick = function () {
                var nextEle = getNextEle(this); if (nextEle != null) { if (nextEle.style.display == "none") { hideAllPage(); } }
                showSubPage(this);
            }
            var pcChild = document.createElement("div"); if (i != where) { pcChild.style.display = "none"; }
            pc.appendChild(pcChild); var toj = 0; if (i == pcCount - 1) { toj = pageCount + 1; } else { toj = (i + 1) * 10 + 1; }
            for (var j = i * 10 + 1; j < toj; j++) {
                var pDiv = document.createElement("div"); pDiv.innerHTML = "第" + j + "页"; pDiv.setAttribute("data-index", j - 1); pDiv.className = "pgdiv"; pDiv.onclick = function () { goPage(this); }
                pcChild.appendChild(pDiv);
            }
            $id("pageInfo").appendChild(pc);
        }
    }
    function setPageInShow() { hideAllPage(); var nowIdx = parseInt($id("pageIndex").innerHTML); var pgId = "pg" + Math.floor((nowIdx - 1) / 10); var nextEle = getNextEle($id(pgId).firstChild); if (nextEle != null) { nextEle.style.display = "block"; } }
    function hideAllPage() { var pInfo = $id("pageInfo"); for (var i = 0; i < pInfo.childNodes.length; i++) { var nextEle = getNextEle(pInfo.childNodes[i].firstChild); if (nextEle != null) { nextEle.style.display = "none"; } } }
    function showSubPage(pg) { var nextEle = getNextEle(pg); if (nextEle != null) { if (nextEle.style.display == "none") { nextEle.style.display = "block"; } else { nextEle.style.display = "none"; } } }
    function getBefore(ele, idx) {
        var rtnEle = getPreEle(ele); if (rtnEle == null) { return ele; }
        var preIdx = parseInt(rtnEle.id.replace("p", "")); if (preIdx > idx) { return getBefore(rtnEle, idx); } else { return ele; }
    }
    function getNextEle(ele) { if (isIE8) { return ele.nextSibling; } else { return ele.nextElementSibling; } }
    function getPreEle(ele) { if (isIE8) { return ele.previousSibling; } else { return ele.previousElementSibling; } }
    function getLastEle(ele) { if (isIE8) { return ele.lastChild; } else { return ele.lastElementChild; } }
    function getFirstEle(ele) { if (isIE8) { return ele.firstChild; } else { return ele.firstElementChild; } }
    function setCss(c, o) { for (var p in o) { c.style[p] = o[p]; } }
    $id("addBtn").onclick = function () { scalePage(20); }
    $id("subBtn").onclick = function () { scalePage(-20); }
    function scalePage(val, pos) {
        var ctn = $id("ctn"); var preScale = parseFloat(ctn.getAttribute("data-scale")); var scaleVal = preScale + val; if (scaleVal < 40) { return false; }
        isInDrag = true; if (scaleVal < 103 && scaleVal > 97) { $id("scaleMsg").innerHTML = "缩放：100%"; $id("scaleMsg").style.display = "none"; val = (100 - scaleVal) + val; scaleVal = 100; } else { $id("scaleMsg").innerHTML = "缩放：" + Math.round(scaleVal) + "%"; $id("scaleMsg").style.display = "block"; }
        ctn.setAttribute("data-scale", scaleVal); var idx = parseInt($id("pageIndex").innerHTML) - 1; var offsetTop = $id("p" + idx).offsetTop; var origScrTop = ctn.scrollTop - offsetTop; var origScrLeft = ctn.scrollLeft; var pages = ctn.childNodes; for (var i = 0; i < pages.length; i++) {
            var orig = { width: parseFloat(pages[i].style.width) * 100 / preScale, height: parseFloat(pages[i].style.height) * 100 / preScale }
            pages[i].style.width = orig.width * scaleVal / 100 + "px"; pages[i].style.height = orig.height * scaleVal / 100 + "px"; for (var j = 0; j < pages[i].childNodes.length; j++) { pages[i].childNodes[j].style.width = orig.width * scaleVal / 100 + "px"; pages[i].childNodes[j].style.height = orig.height * scaleVal / 100 + "px"; }
        }
        var w0 = getWinSz(true); var h0 = getWinSz(false); if (ctn.scrollWidth > w0) { ctn.style.overflowX = "scroll"; } else { ctn.style.overflowX = "hidden"; }
        if (pos != undefined) {
            if (origScrTop < 0) { ctn.scrollTop = $id("p" + idx).offsetTop + origScrTop + (pos.y + origScrTop) * (val / 100); } else { ctn.scrollTop = $id("p" + idx).offsetTop + origScrTop + (pos.y) * (val / 100); }
            ctn.scrollLeft = origScrLeft + pos.x * (val / 100);
        } else {
            if (origScrTop < 0) { ctn.scrollTop = $id("p" + idx).offsetTop + origScrTop + (h0 / 2 + origScrTop) * (val / 100); } else { ctn.scrollTop = $id("p" + idx).offsetTop + origScrTop + h0 / 2 * (val / 100); }
            var pgW = parseFloat($id("p" + idx).style.width); if (origScrLeft == 0) { if (pgW > w0) { var prePgW = pgW / scaleVal * preScale; if (prePgW < w0) { ctn.scrollLeft = (pgW - w0) / 2; } } } else { ctn.scrollLeft = origScrLeft + (pgW / (scaleVal / 100)) / 2 * (val / 100); }
        }
        isInDrag = false;
    }
    function hidePage(hide, idx) { if (hide) { $id("p" + idx).style.display = "none"; $id("nextMsg").style.display = "none"; $id("preMsg").style.display = "none"; } else { $id("p" + idx).style.display = "block"; $id("nextMsg").style.display = "block"; $id("preMsg").style.display = "block"; } }
    !function () {
        var pos = { x0: 0, y0: 0, x1: 0, y1: 0, onDouFinger: false }
        var ctn = $id("ctn"); ctn.ontouchstart = function (event) {
            if (event.touches[1] == undefined) { return false; }
            pos.onDouFinger = true; pos.x0 = event.touches[0].pageX; pos.y0 = event.touches[0].pageY; pos.x1 = event.touches[1].pageX; pos.y1 = event.touches[1].pageY;
        }
        ctn.ontouchmove = function (event) {
            if (!pos.onDouFinger || event.touches[1] == undefined) { return false; }
            var size0 = { w: Math.abs(pos.x0 - pos.x1), h: Math.abs(pos.y0 - pos.y1) }
            var x0 = event.touches[0].pageX; var y0 = event.touches[0].pageY; var x1 = event.touches[1].pageX; var y1 = event.touches[1].pageY; var size1 = { w: Math.abs(x0 - x1), h: Math.abs(y0 - y1) }
            var L0 = Math.sqrt(size1.w * size1.w + size1.h * size1.h); var L1 = Math.sqrt(size0.w * size0.w + size0.h * size0.h); var addNum = ((L0 / L1) * 100 - 100); var midPos = { x: x0 + (x1 - x0) / 2, y: y0 + (y1 - y0) / 2 }; scalePage(addNum, midPos); pos.x0 = x0; pos.y0 = y0; pos.x1 = x1; pos.y1 = y1;
        }
        ctn.ontouchend = function (event) { pos.onDouFinger = false; }
    }(); !function () {
        var mPos = { y: 0, onSlide: false }; var ismobile = ("ontouchstart" in window); if (!isIE8) { $id("pageInfo").addEventListener(evtName.start, touchStart, false); $id("pageInfo").addEventListener(evtName.move, touchMove, false); $id("pageInfo").addEventListener(evtName.end, touchEnd, false); }
        function touchStart(event) { var touch = ev(event, ismobile); mPos.y = touch.clientY; mPos.onSlide = true; }
        function touchMove(event) { if (mPos.onSlide) { var touch = ev(event, ismobile); var tchY = touch.clientY; var offY = (tchY - mPos.y); $id("pageInfo").scrollTop -= offY; mPos.y = tchY; } }
        function touchEnd() { mPos.onSlide = false; }
    }(); function waitOnMsg(msg) {
        if ($id("waitmsg").style.display == "none") {
            if (msg == undefined) { getFirstEle($id("waitmsg")).innerHTML = "正在加载"; } else { getFirstEle($id("waitmsg")).innerHTML = msg; }
            $id("waitmsg").style.display = "block"; setTimeout(function () { $id("waitmsg").style.display = "none"; }, 1500);
        }
    }
    var recall = { record: false, paged: false, sn: -1, snAlrdy: -1, uid: "", did: "", startTime: 0 }
    !function () {
        rcInit(); function rcInit() {
        recall.record = (getParm("record") == 1); recall.paged = !(getParm("paged") == 0); recall.sn = parseInt(getParm("sn")); if (isNaN(recall.sn)) { recall.sn = 0; }
            recall.snAlrdy = recall.sn; if (recall.record) { recall.uid = getParm("uid"); recall.did = getParm("did"); recall.startTime = (new Date()).getTime(); }
        }
        window.recallTo = function (idx, isClose) {
        recall.snAlrdy = Math.max(recall.snAlrdy, idx + 1); if (!recall.record || idx < 0) { return; }
            var pageCount = $id("pageCount").innerHTML; if (pageCount == "") { return; }
            var docid = getParm("did"); var isEn = false; if (docid == null) { docid = $id("Url").value; isEn = true; }
            var nowTm = (new Date()).getTime(); var tmElapsed = nowTm - recall.startTime; recall.startTime = nowTm; var xmlhttp; if (window.XMLHttpRequest) { xmlhttp = new XMLHttpRequest(); } else { xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); }
            xmlhttp.onreadystatechange = function () { if (xmlhttp.readyState == 4) { if (xmlhttp.status != 200) { $id("msg").innerHTML = "上传进度出错了"; $id("msg").style.display = "block"; } else { } } }; var enfurl = "?pageIndex=" + (idx + 1) + "&pageCount=" + pageCount + "&userID=" + encodeURIComponent(getParm("uid")) + "&isEn=" + isEn + "&timeElapsed=" + tmElapsed + "&IsCloseDoc=" + isClose + "&docID=" + encodeURIComponent(docid); xmlhttp.open("POST", "ReadProc/SendProc" + enfurl, true); xmlhttp.send();
        }
        window.MobiReport = function () {
            if ($id("IsMobi").value != "true" || document.hidden || !recall.record) { return; }
            var nowTm = (new Date()).getTime(); var xmlhttp = new XMLHttpRequest(); xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4) {
                    if (xmlhttp.status == 200) {
                        switch (xmlhttp.responseText) { case "ok": break; case "reset": recall.startTime = nowTm; break; }
                        setTimeout(window.MobiReport, 1000);
                    }
                }
            }; var idx = $id("pageIndex").innerHTML; var pageCount = $id("pageCount").innerHTML; if (pageCount == "0") { return false; }
            var docid = getParm("did"); var isEn = false; if (docid == null) { docid = $id("Url").value; isEn = true; }
            var tmElapsed = nowTm - recall.startTime; var enfurl = "?pageIndex=" + idx + "&pageCount=" + pageCount + "&userID=" + encodeURIComponent(getParm("uid")) + "&isEn=" + isEn + "&timeElapsed=" + tmElapsed + "&docID=" + encodeURIComponent(docid); xmlhttp.open("POST", "ReadProc/MobiState" + enfurl, true); xmlhttp.send();
        }
        if (!isIE8) { document.addEventListener("visibilitychange", function () { if (document.hidden) { } else { if (recall != undefined) { recall.startTime = (new Date()).getTime(); MobiReport(); } } }); }
    }();
</script></body></html>